# GPU parallel programming course(openMP and openCL)
#### Student: Utusikov Oleg, M3336.

## Tasks:
- Matrix product.
- Count inclusive prefix sums.

### Matrix multiply:
Исходный код содержится в MatrixCL и function_matrix.cl

Код кернела использует оптимизации за счет использования локальной памяти группы,
транспонирование входной матрицы, разбиение на тайлы, а также увеличение нагрузки на один поток.

На вход подаются 2 входных матрицы доступных на чтение, матрица результата доступная на запись, а также размеры матриц.
Количество элементов на один поток и размер группы задаются через параметры компиляции.

Тайлы имеют размер LOCAL_GROUP_SIZE * LOCAL_GROUP_SIZE.
Все размерноси матриц должны делиться на LOCAL_GROUP_SIZE. Код в main.cpp увеличивает размеры матриц до необходимых.

Итоговая производительность отдичается в 10-20 раз от заявленной производителем видеокарты.

Дальнейшие оптимизации: уменьшить количество конфликтов банков, а также обеспечить когерентный доступ к памяти + изменить размеры тайлов на прямоугольные.
### Prefix sums:
Исходный код содержится в PrefSumCL и function_pref_sum.cl

Текущая реализация может обрабатывать массивы, которые помещаются в локальную память.

Были попытки с расширением матриц до произвольных размеров, путем разбиения входных данных на группы, но неудачные.

Дальнейшие оптимизации: увеличение работы на один поток в группе, и вычисление результата в локальной памяти.

